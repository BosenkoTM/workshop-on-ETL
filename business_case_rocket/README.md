# Бизнес-кейс «Rocket»

Самостоятельная работа

5.1.1. Развернуть ВМ [ubuntu_mgpu.ova](https://disk.yandex.ru/d/Psofa9xtbgUEOw) в [VirtualBox](https://disk.yandex.ru/d/3fD00plnL_a4Cw).

5.1.2. Клонировать на ПК задание **Бизнес-кейс «Rocket»** в домашний каталог ВМ. 

`git clone https://github.com/BosenkoTM/workshop-on-ETL.git`

5.1.3. Запустить контейнер с кейсом, изучить  основные элементы `DAG` в `Apache Airflow`. 
   - Создать `DAG` согласно алгоритму, который предоставит преподаватель.
   - Изучить логи, выполненного DAG. Скачать логи из контейнера на основную ОС, используя команду:

```bash
docker cp <container_hash>:/path/to/zip/file.zip /path/on/host/new_name.zip
```
   - Выгрузить полученный результат работы `DAG` в основной каталог ОС, используя команду:

```bash
docker cp -r <containerId>:/path/to/directory /path/on/host 
```
**5.1.4.** Создать исполняемый файл с расширением `.sh`, который автоматизирует выгрузку данных из контейнера в основную ОС данных, полученные в результате работы `DAG` в `Apache Airflow`. 

5.1.5. Спроектировать верхнеуровневую архитектуру аналитического решения задания **Бизнес-кейса «Rocket»** в `draw.io`. Необходимо использовать:
   - `Source Layer` - слой источников данных.
   - `Storage Layer` - слой хранения данных.
   - `Business Layer` - слой для доступа к данным пользователей.

5.1.6. Спроектировать архитектуру `DAG` **Бизнес-кейса «Rocket»** в `draw.io`. Необходимо использовать:
   - `Source Layer` - слой источников данных.
   - `Storage Layer` - слой хранения данных.
   - `Business Layer` - слой для доступа к данным пользователей.

5.1.7. Построить диаграмму Ганта работы `DAG` в `Apache Airflow`.

5.1.8. Результаты исследований представить в виде файла `ФИО-05.pdf`, в котором отражены следующие результаты:
- постановка задачи;
- исходный код всех DAGs, которые требовались для решения задачи, а также представить граф `DAG` в `Apache Airflow`;
- верхнеуровневая архитектура задания **Бизнес-кейса «Rocket»**, выполненная в `draw.io`;
- архитектура `DAG` **Бизнес-кейса «Rocket»** , выполненная в `draw.io`;
- скрин лог-файла результаов работы `DAGs` в `Apache Airflow`;
- диаграмма Ганта `DAG` в `Apache Airflow`.

После проверки преподавателем работоспособности `DAG`, выгрузить отчет на портал [moodle](http://95.131.149.21/moodle/mod/assign/view.php?id=747).

Конечный `DAG` для тестирования - `listing_2_10.py`.

## Использование

Чтобы начать работу с примерами кода, запустите `Airflow` с помощью `Docker Compose`, выполнив команду:

Для версии `v1`:

```bash
docker-compose up -d
```
Для версии `v2`:

```bash
docker compose up -d
```

Веб-сервер инициализирует несколько задач, поэтому подождите несколько секунд, после чего сможете получить доступ к веб-серверу Airflow по адресу http://localhost:8080.

Чтобы остановить выполнение примеров, выполните следующую команду:

Для версии `v1`:

```bash
docker-compose down -v
```
Для версии `v2`:

```bash
docker compose down -v
```
